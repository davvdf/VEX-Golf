// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        6               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// LineTrackerB         line          B               
// LineTrackerC         line          C               
// LineTrackerD         line          D               
// LineTrackerE         line          E               
// Drivetrain           drivetrain    11, 20          
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        6               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// LineTrackerB         line          B               
// LineTrackerC         line          C               
// LineTrackerD         line          D               
// LineTrackerE         line          E               
// Drivetrain           drivetrain    11, 20          
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        6               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// LineTrackerB         line          B               
// LineTrackerC         line          C               
// LineTrackerD         line          D               
// LineTrackerE         line          E               
// Drivetrain           drivetrain    11, 20          
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        6               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// LineTrackerB         line          B               
// LineTrackerC         line          C               
// LineTrackerD         line          D               
// LineTrackerE         line          E               
// Drivetrain           drivetrain    11, 20          
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        6               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// LineTrackerB         line          B               
// LineTrackerC         line          C               
// LineTrackerD         line          D               
// LineTrackerE         line          E               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// LineTrackerB         line          B               
// LineTrackerC         line          C               
// LineTrackerD         line          D               
// LineTrackerE         line          E               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// LineTrackerB         line          B               
// LineTrackerC         line          C               
// LineTrackerD         line          D               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// LineTrackerB         line          B               
// LineTrackerC         line          C               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// LineTrackerB         line          B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// rightDist            distance      18              
// leftDist             distance      12              
// LineTrackerA         line          A               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// rightDist            distance      18              
// leftDist             distance      12              
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// rightDist            distance      18              
// leftDist             distance      12              
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// rightSense           distance      18              
// leftDist             distance      12              
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// rightSense           distance      18              
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// Distance18           distance      18              
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// ---- END VEXCODE CONFIGURED DEVICES ----
/*----------------------------------------------------------------------------*/
/*                                                                            */
/*    Module:       main.cpp                                                  */
/*    Author:       C:\Users\david                                            */
/*    Created:      Fri Dec 16 2022                                           */
/*    Description:  V5 project                                                */
/*                                                                            */
/*----------------------------------------------------------------------------*/

// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Drivetrain           drivetrain    11, 20          
// armMotor             motor         19              
// clawMotor            motor         1               
// Vision6              vision        9               
// ---- END VEXCODE CONFIGURED DEVICES ----

#include "vex.h"

using namespace vex;

int thresholdVal = 50;
bool hasBall;

void driveSense(){
  Brain.Screen.setCursor(1,1);
  Brain.Screen.print("finding tee");
  if (LineTrackerB.reflectivity()>thresholdVal){
    Drivetrain.drive(reverse);
  } else if (LineTrackerA.reflectivity()>thresholdVal){
    Drivetrain.turnFor(right, 1, degrees);
    wait(5, msec);
  } else if (LineTrackerC.reflectivity()>thresholdVal){
    Drivetrain.turnFor(left, 1, degrees);
    wait(5, msec);
  } else if (LineTrackerE.reflectivity()>thresholdVal){
    Drivetrain.driveFor(reverse, 210, mm);
    Drivetrain.turnFor(left, 90, degrees);
  } else if (LineTrackerD.reflectivity()>thresholdVal){
    Drivetrain.driveFor(reverse, 210, mm);
    Drivetrain.turnFor(right, 90, degrees);
  } 
}

void getBall(){
  Brain.Screen.setCursor(1,1);
  Brain.Screen.print("finding ball");
  Drivetrain.drive(forward);
  Vision6.takeSnapshot(Vision6__BALL);
  Brain.Screen.print(Vision6.objects[0].exists);
  if (Vision6.largestObject.centerY > 90){
    Drivetrain.stop();
    Brain.Screen.setCursor(1,1);
    Brain.Screen.print("found ball!");
    clawMotor.spin(forward);
    armMotor.spinToPosition(90, degrees);
    armMotor.stop();        
    wait(2,seconds);
    clawMotor.stop();
    armMotor.spinToPosition(90, degrees);
    hasBall = true;
  }
}

void senseT(){
  if (LineTrackerD.reflectivity()>thresholdVal && LineTrackerE.reflectivity()>thresholdVal && LineTrackerB.reflectivity()>thresholdVal){
    Drivetrain.stop();
    armMotor.spinToPosition(260, degrees);
    wait(3, sec);
    armMotor.spinToPosition(190, degrees);
    hasBall = false;
    Brain.Screen.setCursor(1,1);
    Brain.Screen.print("finding next ball");
    if (rightDist.objectDistance(mm) > 250){
      Drivetrain.turnFor(right , 90, degrees);
    }
    if (leftDist.objectDistance(mm) > 250){
      Drivetrain.turnFor(left, 90, degrees);
    }
    Drivetrain.driveFor(forward, 500, mm);
    
    
    if ( leftDist.objectDistance(mm) < rightDist.objectDistance(mm)){
      Drivetrain.turnFor(left,90,degrees);
<<<<<<< Updated upstream
    }
    else {
      Drivetrain.turnFor(right,90,degrees);
=======
      Brain.Screen.clearScreen();
      Brain.Screen.print("turning left");
      wait(2,sec);
    }
    else {
      Drivetrain.turnFor(right,90,degrees);
      Brain.Screen.clearScreen();
      Brain.Screen.print("turning right");
      wait(2,sec);
>>>>>>> Stashed changes
    }
  }
}

int main() {
  // Initializing Robot Configuration. DO NOT REMOVE!
  vexcodeInit();
  armMotor.setVelocity(50, percent);
  armMotor.spinToPosition(190, degrees);
  Drivetrain.setDriveVelocity(10, percent);
  Drivetrain.setTurnVelocity(25, percent);
  hasBall = false;
  Brain.Screen.setCursor(1,1);
  Brain.Screen.print("test");
  while (true) {
    
    if (hasBall == false){
      getBall();
      Brain.Screen.setCursor(1,1);
      Brain.Screen.print("test");
    } else {
      driveSense();
      senseT();
    }
  } 
}
